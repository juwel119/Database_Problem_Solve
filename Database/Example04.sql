DROP TABLE meve_employee_ex4
DROP TABLE meve_works_ex4
DROP TABLE meve_company_ex4
DROP TABLE meve_manages_ex4


CREATE TABLE meve_employee_ex4 (employee_name varchar(10), street varchar(10), city varchar(10), PRIMARY KEY(employee_name))
CREATE TABLE meve_company_ex4 (company_name varchar(10), city varchar(10), PRIMARY KEY(company_name))

CREATE TABLE meve_works_ex4 (employee_name varchar(10), company_name varchar(10), salary NUMBER(8), PRIMARY KEY(employee_name), FOREIGN KEY(employee_name) REFERENCES meve_employee_ex4(employee_name), FOREIGN KEY(company_name) REFERENCES meve_company_ex4(company_name))
CREATE TABLE meve_manages_ex4 (employee_name varchar(10), manager_name varchar(10), PRIMARY KEY(employe_name), FOREIGN KEY(employee_name) REFERENCES meve_employee_ex4(employee_name))


INSERT INTO meve_employee_ex4 VALUES ('Arif', '51 Uposohor', 'Rajshahi') INSERT INTO meve_employee_ex4 VALUES ('Sumon', '12 East', 'Moynamati') INSERT INTO meve_employee_ex4 VALUES ('Sagor', 'Neemgacci', 'Sirajgong') INSERT INTO meve_employee_ex4 VALUES ('Abdul', 'Bindopur', 'Rajshahi') INSERT INTO meve_employee_ex4 VALUES ('Himesh', 'Nazrul Aveneu', 'Dhaka') INSERT INTO meve_employee_ex4 VALUES ('Amirul', 'Chawk Bazar', 'Sylhet') INSERT INTO meve_employee_ex4 VALUES ('Sajib', '99 North', 'Chittagong')
INSERT INTO MEVE_COMPANY_EX4 VALUES ('Agrani','Rajshahi') INSERT INTO MEVE_COMPANY_EX4 VALUES ('Sonali','Sylhet') INSERT INTO MEVE_COMPANY_EX4 VALUES ('Janata','Dhaka')
INSERT INTO MEVE_WORKS_EX4 VALUES ('Sumon', 'Agrani', 12000) INSERT INTO MEVE_WORKS_EX4 VALUES ('Abdul', 'Sonali', 13000) INSERT INTO MEVE_WORKS_EX4 VALUES ('Himesh', 'Agrani', 6000) INSERT INTO MEVE_WORKS_EX4 VALUES ('Amirul', 'Sonali', 20000) INSERT INTO MEVE_WORKS_EX4 VALUES ('Sagor', 'Sonali', 8000) INSERT INTO MEVE_WORKS_EX4 VALUES ('Arif', 'Janata', 13000) INSERT INTO MEVE_WORKS_EX4 VALUES ('Sajib', 'Janata', 9000)
INSERT INTO MEVE_MANAGES_EX4 VALUES ('Amirul','Amirul') INSERT INTO MEVE_MANAGES_EX4 VALUES ('Abdul','Amirul') INSERT INTO MEVE_MANAGES_EX4 VALUES ('Sagor','Amirul') INSERT INTO MEVE_MANAGES_EX4 VALUES ('Sumon','Sumon') INSERT INTO MEVE_MANAGES_EX4 VALUES ('Himesh','Sumon') INSERT INTO MEVE_MANAGES_EX4 VALUES ('Arif','Arif') INSERT INTO MEVE_MANAGES_EX4 VALUES ('Sajib','Arif')


/*2*/SELECT employee_name FROM MEVE_WORKS_EX4 WHERE company_name= 'Sonali'
/*3*/SELECT me.EMPLOYEE_NAME, street, city FROM MEVE_EMPLOYEE_EX4 me, MEVE_WORKS_EX4 mw WHERE me.EMPLOYEE_NAME = mw.EMPLOYEE_NAME AND company_name= 'Agrani'
/*4*/SELECT me.EMPLOYEE_NAME, street, city FROM MEVE_EMPLOYEE_EX4 me, MEVE_WORKS_EX4 mw WHERE me.EMPLOYEE_NAME = mw.EMPLOYEE_NAME AND company_name= 'Sonali' AND salary*12>120000
/*5*/SELECT me.EMPLOYEE_NAME FROM MEVE_EMPLOYEE_EX4 me, MEVE_WORKS_EX4 mw, MEVE_COMPANY_EX4 mc WHERE me.EMPLOYEE_NAME = mw.EMPLOYEE_NAME  AND mc.COMPANY_NAME = mw.COMPANY_NAME AND me.CITY = mc.CITY 

/*6*/SELECT me.EMPLOYEE_NAME FROM MEVE_EMPLOYEE_EX4 me, MEVE_MANAGES_EX4 mm WHERE me.EMPLOYEE_NAME = mm.EMPLOYEE_NAME AND me.STREET = (SELECT STREET FROM MEVE_EMPLOYEE_EX4 me2, MEVE_MANAGES_EX4 mm2 WHERE me2.EMPLOYEE_NAME = mm2.EMPLOYEE_NAME)
SELECT  STREET FROM MEVE_EMPLOYEE_EX4 me2, MEVE_MANAGES_EX4 mm2 WHERE me2.EMPLOYEE_NAME = mm2.EMPLOYEE_NAME 

/*7*/SELECT employee_name FROM MEVE_WORKS_EX4 WHERE company_name != 'Sonali'
/*8*/SELECT EMPLOYEE_NAME, COMPANY_NAME FROM MEVE_WORKS_EX4 WHERE SALARY > (SELECT MAX(SALARY) FROM MEVE_WORKS_EX4 WHERE COMPANY_NAME = 'Janata')
/*9*/SELECT employee_name FROM MEVE_WORKS_EX4 WHERE SALARY > (SELECT AVG(salary) FROM MEVE_WORKS_EX4 )
/*10*/ SELECT MAX(COMPANY_NAME) FROM MEVE_WORKS_EX4
/*11*/SELECT mc.company_name FROM MEVE_COMPANY_EX4 mc, MEVE_WORKS_EX4 mw WHERE mc.COMPANY_NAME = mw.COMPANY_NAME AND mw.SALARY = (SELECT MIN(salary) FROM MEVE_WORKS_EX4)
/*12*/SELECT EMPLOYEE_NAME, COMPANY_NAME FROM MEVE_WORKS_EX4 WHERE SALARY > (SELECT AVG(SALARY) FROM MEVE_WORKS_EX4 WHERE COMPANY_NAME = 'Agrani')
/*13*/UPDATE MEVE_EMPLOYEE_EX4 SET city = 'Natore' WHERE EMPLOYEE_NAME = 'Arif'
/*14*/UPDATE MEVE_WORKS_EX4 SET SALARY = SALARY + (SALARY*(10/100)) WHERE COMPANY_NAME = 'Agrani'
/*15*/UPDATE MEVE_WORKS_EX4 SET SALARY = SALARY + (SALARY*(10/100)) WHERE EMPLOYEE_NAME = (SELECT DISTINCT manager_name FROM MEVE_EMPLOYEE_EX4 me, MEVE_WORKS_EX4 mw, MEVE_MANAGES_EX4 mm WHERE me.EMPLOYEE_NAME = mw.EMPLOYEE_NAME AND me.EMPLOYEE_NAME =mm.EMPLOYEE_NAME AND COMPANY_NAME = 'Agrani')

/*16*/ UPDATE MEVE_MANAGES_EX4 SET CASE salary< 19000 WHEN salary= salary+ salary*(10/100) ELSE salary= salary+ salary*(3/100) WHERE EMPLOYEE_NAME = (SELECT DISTINCT manager_name FROM MEVE_MANAGES_EX4 mm, MEVE_WORKS_EX4 mw WHERE mm.MANAGER_NAME = MW.EMPLOYEE_NAME )
--SELECT DISTINCT manager_name FROM MEVE_MANAGES_EX4 mm, MEVE_WORKS_EX4 mw WHERE mm.MANAGER_NAME = MW.EMPLOYEE_NAME 

/*17*/ DELETE FROM MEVE_WORKS_EX4 WHERE COMPANY_NAME = 'Janata'
/*18*/

/*sub query of 15*/SELECT DISTINCT manager_name FROM MEVE_EMPLOYEE_EX4 me, MEVE_WORKS_EX4 mw, MEVE_MANAGES_EX4 mm WHERE me.EMPLOYEE_NAME = mw.EMPLOYEE_NAME AND me.EMPLOYEE_NAME =mm.EMPLOYEE_NAME AND COMPANY_NAME = 'Agrani'



ALTER TABLE meve_employee_ex4 MODIFY street varchar(20)

SELECT * FROM meve_employee_ex4
SELECT * FROM meve_works_ex4
SELECT * FROM meve_company_ex4
SELECT * FROM meve_manages_ex4